# CopernicusDataspace

The [Copernicus Data Space Ecosystem](https://dataspace.copernicus.eu/),
is an open ecosystem that provides free instant access to a wide range
of data and services from the Copernicus Sentinel missions and more on
our planet’s land, oceans and atmosphere. This package provides entry
points to several APIs allowing users to access the data directly in R.

## Installation

At the moment, the package is still only experimental. It can therefore
only be installed from GitHub:

``` r
remotes::install_github("pepijn-devries/CopernicusDataspace")
```

## Introduction

The Copernicus Data Space Ecosystem offers access to its services
through several
[APIs](https://documentation.dataspace.copernicus.eu/APIs.html). This
package offers access via the following APIs:

- [OData](https://documentation.dataspace.copernicus.eu/APIs/OData.html);
- [STAC](https://documentation.dataspace.copernicus.eu/APIs/STAC.html);
  and
- [SentinelHub](https://documentation.dataspace.copernicus.eu/APIs/SentinelHub.html).

This README shows only essential methods for downloading data. For more
detailed information consult the respective vignettes:

- [`vignette("OData")`](https://pepijn-devries.github.io/CopernicusDataspace/articles/OData.md);
- [`vignette("STAC")`](https://pepijn-devries.github.io/CopernicusDataspace/articles/STAC.md);
  and
- [`vignette("SentinelHub")`](https://pepijn-devries.github.io/CopernicusDataspace/articles/SentinelHub.md)

## Authentication

When actually downloading files from the Copernicus Data Space
Ecosystem, you usually need some form of authentication. Examples below
use credentials stored as environment variables. For more information
about how to effectively authenticate download requests, please see
[`vignette("Authentication")`](https://pepijn-devries.github.io/CopernicusDataspace/articles/Authentication.md).

## Downloading Using STAC Catalogue

When you know the STAC identifier (`asset_id`) and the asset name you
wish to download, you can simply use the example shown below. It will
often speed you request up if you include the `collection` id. When you
don’t know these details, you should first explore the catalogue. Please
see
[`vignette("STAC")`](https://pepijn-devries.github.io/CopernicusDataspace/articles/STAC.md)
for more details on working with the STAC catalogue.

``` r
library(CopernicusDataspace)
library(stars) ## For reading and plotting the downloaded file

## Only run this if an S3 secret is specified:
if (dse_has_s3_secret()) {
  
  filename  <- dse_stac_download(
    asset_id   = "Copernicus_DSM_COG_30_S69_00_W062_00_DEM",
    asset      = "data",
    collection = "cop-dem-glo-90-dged-cog",
    tempdir())
  
  tile_stac <- read_stars(filename)
  
  plot(tile_stac, col = hcl.colors(100), axes = TRUE)
  
}
```

![Example of downloading with STAC
API](reference/figures/README-download-stac-1.png)

This produces a tile in the Southern Ocean near Antarctica.

## Downloading Using OData API

``` r

## Only run this if client info is available:
if (dse_has_client_info()) {
  response <-
    dse_odata_download_path(
    product     = "2f497806-0101-5eea-83fa-c8f68bc56b0c",
    node_path   = paste(
      "DEM1_SAR_DTE_90_20101213T034716_20130408T035028_ADS_000000_5033.DEM",
      "Copernicus_DSM_30_S09_00_E026_00", "DEM",
      "Copernicus_DSM_30_S09_00_E026_00_DEM.dt1", sep = "/"),
    destination = tempdir())
  
  tile_odata <- read_stars(response$body)
  plot(tile_odata, col = terrain.colors(100), axes = TRUE)
}
```

![Example of downloading with OData
API](reference/figures/README-download-odata-1.png)

This produces a map of Lake Upemba in Congo.

TODO

## Downloading Using SentinelHub

TODO

``` r
## Only run this if client info is available:
if (dse_has_client_info()) {
  bounds <- c(5.261, 52.680, 5.319, 52.715)

  ## prepare input data:
  input <-
    dse_sh_prepare_input(
      bounds = bounds,
      time_range = c("2025-06-01 UTC", "2025-07-01 UTC")
    )

  ## prepare ouput format:
  output <- dse_sh_prepare_output(bbox = bounds)

  ## retrieve processing script:
  evalscript <- dse_sh_get_custom_script("/sentinel-2/l2a_optimized/")

  ## destination file:
  fl <- tempfile(fileext = ".tiff")
  
  ## send request and download result:
  dse_sh_process(input, output, evalscript, fl)

  ## read and plot result:
  enkhuizen <- read_stars(fl) |> suppressWarnings()
  plot(enkhuizen, rgb = 1:3, main = "Enkhuizen")
}
```

![Example of downloading with Sentinel Hub
API](reference/figures/README-download-sentinelhub-1.png)

## Function Names

Understanding the naming logic of the functions in this package, will
help you navigating through all features, and effictively use them.

Most function names in this package start with the acronym `dse` (Data
Space Ecosystem). This is done to avoid confusion with other Copernicus
packages (see below) and unintended masking of other functions.

Exceptions are functions that (intentionally) mask functions from other
packages (like
[`req_perform()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/req_perform.md)),
and functions that implement generic functions from tidyverse packages
(see
[`?tidy_verbs`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)).

Functions are also grouped to highlight the specific API they support.
After the `dse` acronym, these function names contain a reference to the
relevant API (`odata`, `stac` and `sh` (SentinelHub)). If a function
name starts with `dse` but is not followed by a reference to a specific
API, it will have a more generic purpose (like for instance
authorisation).

## More of Copernicus

More R packages for exploring other Copernicus data services:

- [CopernicusClimate](https://github.com/pepijn-devries/CopernicusClimate)
  Dedicated to climate change datasets
- [CopernicusMarine](https://github.com/pepijn-devries/CopernicusMarine)
  Dedicated to marine datasets

## Code of Conduct

Please note that the CopernicusDataspace project is released with a
[Contributor Code of
Conduct](https://contributor-covenant.org/version/2/1/CODE_OF_CONDUCT.html).
By contributing to this project, you agree to abide by its terms.

# Package index

## All functions

- [`dse_access_token()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_access_token.md)
  [`dse_client_id()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_access_token.md)
  [`` `dse_client_id<-`() ``](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_access_token.md)
  [`dse_client_secret()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_access_token.md)
  [`` `dse_client_secret<-`() ``](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_access_token.md)
  [`dse_has_client_info()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_access_token.md)
  : Client Information and Access Token for the Data Space Store API
- [`dse_odata_attributes()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_odata_attributes.md)
  : List OData Attributes
- [`dse_odata_bursts_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_odata_bursts.md)
  [`dse_odata_bursts()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_odata_bursts.md)
  : Create a OData Request for a Data Space Ecosystem Bursts Data
- [`dse_odata_download()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_odata_download.md)
  : Download Data Space Ecosystem Products Through OData API
- [`dse_odata_download_path()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_odata_download_path.md)
  : Alternative Route to Download OData Products
- [`dse_odata_product_nodes()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_odata_product_nodes.md)
  : List OData Product Nodes (i.e. Files and Directories)
- [`dse_odata_products_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_odata_products_request.md)
  [`dse_odata_products()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_odata_products_request.md)
  : Create a OData Request for a Data Space Ecosystem Product
- [`dse_odata_quicklook()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_odata_quicklook.md)
  : Download a Quicklook for a Product
- [`dse_s3()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_s3.md)
  [`dse_has_s3_secret()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_s3.md)
  [`dse_s3_key()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_s3.md)
  [`` `dse_s3_key<-`() ``](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_s3.md)
  [`dse_s3_secret()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_s3.md)
  [`` `dse_s3_secret<-`() ``](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_s3.md)
  : Setup Amazon Simple Storage Service for the Data Space Ecosystem
- [`dse_s3_download()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_s3_download.md)
  : Download Asset Through Uniform Resource Identifier
- [`dse_sh_collections()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_sh_collections.md)
  : List Sentinel Hub Collections
- [`dse_sh_custom_scripts()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_sh_custom_scripts.md)
  : List Custom JavaScripts for Processing Sentinel Hub Data
- [`dse_sh_features()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_sh_features.md)
  : List Sentinel Hub Features
- [`dse_sh_get_custom_script()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_sh_get_custom_script.md)
  : Retrieve Custom JavaScripts to be Used by Sentinel Hub
- [`dse_sh_prepare_input()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_sh_prepare_.md)
  [`dse_sh_prepare_output()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_sh_prepare_.md)
  : Prepare Input and Output Fields for Sentinel Hub Request
- [`dse_sh_process()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_sh_process.md)
  : Process Satellite Data and Download Result
- [`dse_sh_queryables()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_sh_queryables.md)
  : List Queryable Fields on Sentinel Hub
- [`dse_sh_search_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_sh_search_request.md)
  : Create a Request for the SentinelHub Catalogue
- [`dse_sh_use_requests_builder()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_sh_use_requests_builder.md)
  : Use Requests Builder to Send Processing Request to SentinelHub
- [`dse_stac_client()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_stac_client.md)
  : Obtain Information About the STAC Client
- [`dse_stac_collections()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_stac_collections.md)
  : Get a Summary of all Data Space Ecosystem Collections
- [`dse_stac_download()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_stac_download.md)
  : Download Asset From STAC Catalogue
- [`dse_stac_guess_collection()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_stac_guess_collection.md)
  : Guess the Collection id from an Asset id
- [`dse_stac_queryables()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_stac_queryables.md)
  : Get Queryables for a STAC Collection
- [`dse_stac_search_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_stac_search_request.md)
  : Create a Request for a STAC Search in the Data Space Ecosystem
- [`dse_usage()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_usage.md)
  [`dse_user_statistics()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/dse_usage.md)
  : Get Dataspace Account Information
- [`st_intersects.odata_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/geometry.md)
  [`st_intersects.stac_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/geometry.md)
  : Filter OData and STAC Requests Using Geometries
- [`req_perform()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/req_perform.md)
  : Perform a Request to Get a Response
- [`filter.odata_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`filter.sentinel_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`filter.stac_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`compute.odata_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`collect.odata_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`collect.sentinel_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`collect.stac_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`arrange.odata_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`arrange.stac_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`slice_head.odata_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`slice_head.stac_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`slice_head.sentinel_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`select.odata_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`select.stac_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  [`select.sentinel_request()`](https://pepijn-devries.github.io/CopernicusDataspace/reference/tidy_verbs.md)
  : Tidy Verbs for OData, SentinelHub and STAC API Requests

# Articles

### All vignettes

- [Authentication](https://pepijn-devries.github.io/CopernicusDataspace/articles/Authentication.md):
- [Using the OData
  API](https://pepijn-devries.github.io/CopernicusDataspace/articles/OData.md):
- [Using
  SentinelHub](https://pepijn-devries.github.io/CopernicusDataspace/articles/SentinelHub.md):
- [Using the STAC
  Catalogue](https://pepijn-devries.github.io/CopernicusDataspace/articles/STAC.md):
